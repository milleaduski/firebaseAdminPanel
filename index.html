<!DOCTYPE html>
<html>
<head>
	<title>Admin panel firebase</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
</head>
<body>
<div class="container">
   <h1>Admin panel firebase</h1>
    <div id="login">
      <h3>Login admin</h3>
     	<div class="form-group">
  	    <label for="email">Email address:</label>
  	    <input type="email" class="form-control" id="email" autocomplete="off">
    	</div>
    	<div class="form-group">
  	    <label for="pass">Password:</label>
  	    <input type="password" class="form-control" id="pass">
    	</div>
    </div>
	  <button type="submit" id="btnLogin" class="btn btn-primary">Login</button>
	  <button type="submit" id="btnLogout" class="btn btn-danger hidden">logout</button>
    <hr>
    <div id="inputdata">
      <h3>Input Form</h3>
      <div class="form-group">
        <label for="title">Title</label>
        <input type="text" class="form-control" id="title" autocomplete="off">
      </div>
      <div class="form-group">
        <label for="desc">desc:</label>
        <input type="text" class="form-control" id="desc">
      </div>
      <button id="btnAddData" class="btn btn-primary">Add</button>
    </div>
</div>
</body>

<script src="https://www.gstatic.com/firebasejs/5.5.7/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCSPlchU_f5JdqHY3HjcOZREPSy6uiYIaY",
    authDomain: "admin-panel-de482.firebaseapp.com",
    databaseURL: "https://admin-panel-de482.firebaseio.com",
    projectId: "admin-panel-de482",
    storageBucket: "admin-panel-de482.appspot.com",
    messagingSenderId: "274396509060"
  };
  firebase.initializeApp(config);

  var auth = firebase.auth();

  var email 	= document.getElementById('email');
  var pass 		= document.getElementById('pass');
  var btnLogin 	= document.getElementById('btnLogin');
  var btnLogout = document.getElementById('btnLogout');
  var formLogin = document.getElementById('login');
  var formInput = document.getElementById('inputdata');


  btnLogin.addEventListener('click', funcLogin);
  btnLogout.addEventListener('click', funcLogout);

  // Login

  function funcLogin() {
  	auth.signInWithEmailAndPassword(email.value, pass.value)
  		.then(function(data){
  			console.log("the login was successful");
  			// console.log(data);
  			// location.reload();
  		}).catch(function(err){
  			alert(err)
  		})
  }

  //status user
  auth.onAuthStateChanged(function(user){
  		if(user) {
  			//do everthing if user exist.
  			//this means the user is logged in 
  			btnLogout.classList.remove('hidden');
  			btnLogin.classList.add('hidden');
        formLogin.classList.add('hidden');
        formInput.classList.remove('hidden');
  			
  		} else {
  			//do everthing if user exist.
  			//this means the user is logged in 
  			btnLogout.classList.add('hidden');
  			btnLogin.classList.remove('hidden');
        formLogin.classList.remove('hidden');
        formInput.classList.add('hidden');
  		}
  })

  function funcLogout() {
  	auth.signOut().then(function(){
  		console.log("You are logged out")
  	}).catch(function(err){
  		alert(err)
  	})
  }

  // REALTIME DATABASE

  var database  = firebase.database();
  var blogsRef  = database.ref('blogs');

  //ELements

  var title       = document.getElementById('title');
  var desc        = document.getElementById('desc');
  var btnSubmit   = document.getElementById('btnAddData');

  btnSubmit.addEventListener('click', function(){
    blogsRef.push({
      title : title.value,
      desc : desc.value
    })

    title   = '';
    desc    = '';
  });

  blogsRef.on('child_added', addData);

  function addData() {
    console.log("Data successfully added")
  }

</script>
</html>